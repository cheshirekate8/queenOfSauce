{"ast":null,"code":"import { csrfFetch } from \"./csrf.js\";\nimport * as kitchenActions from './kitchen';\nimport * as recipeActions from \"./cookbook\";\nimport * as pantryActions from \"./pantry\";\nconst SET_USER = 'session/setUser';\nconst REMOVE_USER = 'session/removeUser';\n\nconst setUser = user => ({\n  type: SET_USER,\n  payload: user\n});\n\nconst removeUser = () => ({\n  type: REMOVE_USER\n});\n\nexport const login = ({\n  credential,\n  password\n}) => async dispatch => {\n  const response = await csrfFetch(\"/api/session\", {\n    method: \"POST\",\n    body: JSON.stringify({\n      credential,\n      password\n    })\n  });\n  const data = await response.json();\n  dispatch(setUser(data.user));\n  dispatch(kitchenActions.getFridges(data.user.id));\n  dispatch(recipeActions.getRecipes());\n  dispatch(pantryActions.getIngredients());\n  return response;\n};\nexport const restoreUser = () => async dispatch => {\n  const response = await csrfFetch(\"/api/session\");\n  const data = await response.json();\n  dispatch(setUser(data.user));\n\n  if (data.user) {\n    dispatch(kitchenActions.getFridges(data.user.id));\n  }\n\n  return response;\n};\nexport const signup = user => async dispatch => {\n  const {\n    username,\n    email,\n    password\n  } = user;\n  const response = await csrfFetch(\"/api/users\", {\n    method: \"POST\",\n    body: JSON.stringify({\n      username,\n      email,\n      password\n    })\n  });\n  const data = await response.json();\n  dispatch(setUser(data.user));\n  return response;\n};\nexport const logout = () => async dispatch => {\n  const response = await csrfFetch(\"/api/session\", {\n    method: \"DELETE\"\n  });\n  dispatch(removeUser());\n  dispatch(kitchenActions.clearFridges());\n  return response;\n};\nconst initialState = {\n  user: null\n};\n\nfunction reducer(state = initialState, action) {\n  let newState;\n\n  switch (action.type) {\n    case SET_USER:\n      newState = Object.assign({}, state, {\n        user: action.payload\n      });\n      return newState;\n\n    case REMOVE_USER:\n      newState = Object.assign({}, state, {\n        user: null\n      });\n      return newState;\n\n    default:\n      return state;\n  }\n}\n\nexport default reducer;","map":{"version":3,"sources":["/home/cheshirekate8/appAcademyCode/projects/stardewRecipes/solution/frontend/src/store/session.js"],"names":["csrfFetch","kitchenActions","recipeActions","pantryActions","SET_USER","REMOVE_USER","setUser","user","type","payload","removeUser","login","credential","password","dispatch","response","method","body","JSON","stringify","data","json","getFridges","id","getRecipes","getIngredients","restoreUser","signup","username","email","logout","clearFridges","initialState","reducer","state","action","newState","Object","assign"],"mappings":"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","sourcesContent":["import { csrfFetch } from \"./csrf.js\";\nimport * as kitchenActions from './kitchen';\nimport * as recipeActions from \"./cookbook\";\nimport * as pantryActions from \"./pantry\"\n\nconst SET_USER = 'session/setUser';\nconst REMOVE_USER = 'session/removeUser';\n\nconst setUser = (user) => ({\n  type: SET_USER,\n  payload: user,\n});\n\nconst removeUser = () => ({\n  type: REMOVE_USER,\n});\n\nexport const login = ({ credential, password }) => async dispatch => {\n  const response = await csrfFetch(\"/api/session\", {\n    method: \"POST\",\n    body: JSON.stringify({ credential, password }),\n  });\n  const data = await response.json();\n  dispatch(setUser(data.user));\n  dispatch(kitchenActions.getFridges(data.user.id));\n  dispatch(recipeActions.getRecipes())\n  dispatch(pantryActions.getIngredients())\n\n  return response;\n};\n\nexport const restoreUser = () => async dispatch => {\n  const response = await csrfFetch(\"/api/session\");\n  const data = await response.json();\n  dispatch(setUser(data.user));\n  if (data.user) {\n    dispatch(kitchenActions.getFridges(data.user.id));\n  }\n  return response;\n};\n\nexport const signup = (user) => async (dispatch) => {\n  const { username, email, password } = user;\n  const response = await csrfFetch(\"/api/users\", {\n    method: \"POST\",\n    body: JSON.stringify({\n      username,\n      email,\n      password,\n    }),\n  });\n  const data = await response.json();\n  dispatch(setUser(data.user));\n  return response;\n};\n\nexport const logout = () => async (dispatch) => {\n  const response = await csrfFetch(\"/api/session\", {\n    method: \"DELETE\",\n  });\n  dispatch(removeUser());\n  dispatch(kitchenActions.clearFridges())\n  return response;\n};\n\nconst initialState = { user: null };\n\nfunction reducer(state = initialState, action) {\n  let newState;\n  switch (action.type) {\n    case SET_USER:\n      newState = Object.assign({}, state, { user: action.payload });\n      return newState;\n    case REMOVE_USER:\n      newState = Object.assign({}, state, { user: null });\n      return newState;\n    default:\n      return state;\n  }\n}\n\nexport default reducer;\n"]},"metadata":{},"sourceType":"module"}